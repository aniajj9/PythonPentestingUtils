'''
Basic NMAP scanner
No error handling, VERY basic
'''

import nmap

scanner = nmap.PortScanner()

print("Welcome to the custom NMAP scanner")
print("~~~~~~~~~~~~~~~~~~~~~~")

ip_address = input("Enter the IP address to scan: ")
print("The IP to scan is ", ip_address)

response = input("""""\r\n What type of scan would you like to run? 
                    1. SYN ACK Scan
                    2. UDP Scan
                    3. Comprehensive scan \r\n""")
print("You have selected option ", response)

if response == '1':
    print("Nmap version ", scanner.nmap_version())
    scanner.scan(ip_address, "1-1024", "-v -sS")
    print(scanner.scaninfo())
    print("IP status: ", scanner[ip_address].state())
    print(scanner[ip_address].all_protocols())
    print("Open ports: ", scanner[ip_address]['tcp'].keys())

elif response == '2':
    print("Nmap version ", scanner.nmap_version())
    scanner.scan(ip_address, "1-1024", "-v -sU")
    print(scanner.scaninfo())
    print("IP status: ", scanner[ip_address].state())
    print(scanner[ip_address].all_protocols())
    print("Open ports: ", scanner[ip_address]['udp'].keys())

elif response == '3':
    print("Nmap version ", scanner.nmap_version())
    scanner.scan(ip_address, "1-1024", "-v -sS -sV -A -O")
    print(scanner.scaninfo())
    print("IP status: ", scanner[ip_address].state())
    print(scanner[ip_address].all_protocols())
    print("Open ports: ", scanner[ip_address]['tcp'].keys())

else:
    print("Invalid option :<")